<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of supergui</title>
  <meta name="keywords" content="supergui">
  <meta name="description" content="supergui() - a comprehensive gui automatic builder. This function help">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">code</a> &gt; <a href="../index.html">gui</a> &gt; <a href="index.html">private</a> &gt; supergui.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for code/gui/private&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>supergui

</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>supergui() - a comprehensive gui automatic builder. This function help</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [handlers, outheight, allhandlers] = supergui( varargin); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> supergui() - a comprehensive gui automatic builder. This function help
              to create GUI very fast without bothering about the 
              positions of the elements. After creating a geometry, 
              elements just place themselves into the predefined 
              locations. It is especially usefull for figure where you
              intend to put text button and descriptions.

 Usage:
   &gt;&gt; [handlers, width, height ] = ...
             supergui( 'key1', 'val1', 'key2', 'val2', ... );
 
 Inputs:
   'fig'       - figure handler, if not given, create a new figure.
   'geom'      - cell array of cell array of integer vector. Each cell
               array defines the coordinate of a given input in the following
               manner: { nb_row nb_col [x_topcorner y_topcorner]
               [x_bottomcorner y_bottomcorner] };
   'geomhoriz' - integer vector or cell array of numerical vectors describing the 
               geometry of the elements in the figure. 
               - if integer vector, vector length is the number of rows and vector 
               values are the number of 'uilist' elements in each row.
               For example, [2 3 2] means that the
               figures will have 3 rows, with 2 elements in the first
               and last row and 3 elements in the second row.
               - if cell array, each vector describes the relative widths
               of items in each row. For example, { [2 8] [1 2 3] } which means
               that figures will have 2 rows, the first one with 2
               elements of relative width 2 and 8 (20% and 80%). The
               second row will have 3 elements of relative size 1, 2 
               and 3 (1/6 2/6 and 3/6).
   'geomvert' - describting geometry for the rows. For instance
               [1 2 1] means that the second row will be twice the height
               of the other ones. If [], all the lines have the same height.
   'uilist'   - list of uicontrol lists describing elements properties
               { { ui1 }, { ui2 }... }, { 'uiX' } being GUI matlab 
               uicontrol arguments such as { 'style', 'radiobutton', 
               'String', 'hello' }. See Matlab function uicontrol() for details.
   'borders'  - [left right top bottom] GUI internal borders in normalized
               units (0 to 1). Default values are 
   'title'    - optional figure title
   'userdata' - optional userdata input for the figure
   'inseth'   - horizontal space between elements. Default is 2% 
                of window size.
   'insetv'   - vertical space between elements. Default is 2% 
                of window height.
   'spacing'  - [horiz vert] spacing in normalized units. Default 
   'spacingtype' - ['absolute'|'proportional'] abolute means that the 
                spacing values are fixed. Proportional means that they
                depend on the number of element in a line.
   'minwidth' - [integer] minimal width in pixels. Default is none.

 Hint:
    use 'print -mfile filemane' to save a matlab file of the figure.

 Output:
    handlers  - all the handler of the elements (in the same order as the
                uilist input).
    height    - adviced widht for the figure (so the text look nice).   
    height    - adviced height for the figure (so the text look nice).   

 Example:
    figure;   
    supergui( 'geomhoriz', { 1 1 }, 'uilist', { ...
        { 'style', 'radiobutton', 'string', 'radio' }, ...
        { 'style', 'pushbutton' , 'string', 'push' } } );
      
 Author: Arnaud Delorme, CNL / Salk Institute, La Jolla, 2001-

 See also: eeglab()</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">

<li><a href="finputcheck.html" class="code" title="function [g, varargnew] = finputcheck( vararg, fieldlist, callfunc, mode, verbose )">finputcheck</a>	finputcheck() - check Matlab function {'key','value'} input argument pairs</li>
<li><a href="supergui.html" class="code" title="function [handlers, outheight, allhandlers] = supergui( varargin);">supergui</a>	supergui() - a comprehensive gui automatic builder. This function help</li>
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">

<li><a href="listdlg2.html" class="code" title="function [vals, okornot, strval] = listdlg2(varargin);">listdlg2</a>	listdlg2() - listdlg function clone with coloring and help for</li>
<li><a href="questdlg2.html" class="code" title="function [result] = questdlg2(Prompt,Title,varargin);">questdlg2</a>	questdlg2() - questdlg function clone with coloring and help for</li>
<li><a href="supergui.html" class="code" title="function [handlers, outheight, allhandlers] = supergui( varargin);">supergui</a>	supergui() - a comprehensive gui automatic builder. This function help</li>
</ul>
<!-- crossreference -->


<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">

<li><a href="#_sub1" class="code">function [posx posy width height] = getcoord(geom1, geom2, coord1, sz, borders, spacing);</a></li>
<li><a href="#_sub2" class="code">function [posx posy width height] = getcoordold(geom1, geom2, coord1, sz);</a></li>
</ul>




<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% supergui() - a comprehensive gui automatic builder. This function help</span>
0002 <span class="comment">%              to create GUI very fast without bothering about the</span>
0003 <span class="comment">%              positions of the elements. After creating a geometry,</span>
0004 <span class="comment">%              elements just place themselves into the predefined</span>
0005 <span class="comment">%              locations. It is especially usefull for figure where you</span>
0006 <span class="comment">%              intend to put text button and descriptions.</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Usage:</span>
0009 <span class="comment">%   &gt;&gt; [handlers, width, height ] = ...</span>
0010 <span class="comment">%             supergui( 'key1', 'val1', 'key2', 'val2', ... );</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% Inputs:</span>
0013 <span class="comment">%   'fig'       - figure handler, if not given, create a new figure.</span>
0014 <span class="comment">%   'geom'      - cell array of cell array of integer vector. Each cell</span>
0015 <span class="comment">%               array defines the coordinate of a given input in the following</span>
0016 <span class="comment">%               manner: { nb_row nb_col [x_topcorner y_topcorner]</span>
0017 <span class="comment">%               [x_bottomcorner y_bottomcorner] };</span>
0018 <span class="comment">%   'geomhoriz' - integer vector or cell array of numerical vectors describing the</span>
0019 <span class="comment">%               geometry of the elements in the figure.</span>
0020 <span class="comment">%               - if integer vector, vector length is the number of rows and vector</span>
0021 <span class="comment">%               values are the number of 'uilist' elements in each row.</span>
0022 <span class="comment">%               For example, [2 3 2] means that the</span>
0023 <span class="comment">%               figures will have 3 rows, with 2 elements in the first</span>
0024 <span class="comment">%               and last row and 3 elements in the second row.</span>
0025 <span class="comment">%               - if cell array, each vector describes the relative widths</span>
0026 <span class="comment">%               of items in each row. For example, { [2 8] [1 2 3] } which means</span>
0027 <span class="comment">%               that figures will have 2 rows, the first one with 2</span>
0028 <span class="comment">%               elements of relative width 2 and 8 (20% and 80%). The</span>
0029 <span class="comment">%               second row will have 3 elements of relative size 1, 2</span>
0030 <span class="comment">%               and 3 (1/6 2/6 and 3/6).</span>
0031 <span class="comment">%   'geomvert' - describting geometry for the rows. For instance</span>
0032 <span class="comment">%               [1 2 1] means that the second row will be twice the height</span>
0033 <span class="comment">%               of the other ones. If [], all the lines have the same height.</span>
0034 <span class="comment">%   'uilist'   - list of uicontrol lists describing elements properties</span>
0035 <span class="comment">%               { { ui1 }, { ui2 }... }, { 'uiX' } being GUI matlab</span>
0036 <span class="comment">%               uicontrol arguments such as { 'style', 'radiobutton',</span>
0037 <span class="comment">%               'String', 'hello' }. See Matlab function uicontrol() for details.</span>
0038 <span class="comment">%   'borders'  - [left right top bottom] GUI internal borders in normalized</span>
0039 <span class="comment">%               units (0 to 1). Default values are</span>
0040 <span class="comment">%   'title'    - optional figure title</span>
0041 <span class="comment">%   'userdata' - optional userdata input for the figure</span>
0042 <span class="comment">%   'inseth'   - horizontal space between elements. Default is 2%</span>
0043 <span class="comment">%                of window size.</span>
0044 <span class="comment">%   'insetv'   - vertical space between elements. Default is 2%</span>
0045 <span class="comment">%                of window height.</span>
0046 <span class="comment">%   'spacing'  - [horiz vert] spacing in normalized units. Default</span>
0047 <span class="comment">%   'spacingtype' - ['absolute'|'proportional'] abolute means that the</span>
0048 <span class="comment">%                spacing values are fixed. Proportional means that they</span>
0049 <span class="comment">%                depend on the number of element in a line.</span>
0050 <span class="comment">%   'minwidth' - [integer] minimal width in pixels. Default is none.</span>
0051 <span class="comment">%</span>
0052 <span class="comment">% Hint:</span>
0053 <span class="comment">%    use 'print -mfile filemane' to save a matlab file of the figure.</span>
0054 <span class="comment">%</span>
0055 <span class="comment">% Output:</span>
0056 <span class="comment">%    handlers  - all the handler of the elements (in the same order as the</span>
0057 <span class="comment">%                uilist input).</span>
0058 <span class="comment">%    height    - adviced widht for the figure (so the text look nice).</span>
0059 <span class="comment">%    height    - adviced height for the figure (so the text look nice).</span>
0060 <span class="comment">%</span>
0061 <span class="comment">% Example:</span>
0062 <span class="comment">%    figure;</span>
0063 <span class="comment">%    supergui( 'geomhoriz', { 1 1 }, 'uilist', { ...</span>
0064 <span class="comment">%        { 'style', 'radiobutton', 'string', 'radio' }, ...</span>
0065 <span class="comment">%        { 'style', 'pushbutton' , 'string', 'push' } } );</span>
0066 <span class="comment">%</span>
0067 <span class="comment">% Author: Arnaud Delorme, CNL / Salk Institute, La Jolla, 2001-</span>
0068 <span class="comment">%</span>
0069 <span class="comment">% See also: eeglab()</span>
0070 
0071 <span class="comment">% Copyright (C) 2001 Arnaud Delorme, Salk Institute, arno@salk.edu</span>
0072 <span class="comment">%</span>
0073 <span class="comment">% This program is free software; you can redistribute it and/or modify</span>
0074 <span class="comment">% it under the terms of the GNU General Public License as published by</span>
0075 <span class="comment">% the Free Software Foundation; either version 2 of the License, or</span>
0076 <span class="comment">% (at your option) any later version.</span>
0077 <span class="comment">%</span>
0078 <span class="comment">% This program is distributed in the hope that it will be useful,</span>
0079 <span class="comment">% but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
0080 <span class="comment">% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
0081 <span class="comment">% GNU General Public License for more details.</span>
0082 <span class="comment">%</span>
0083 <span class="comment">% You should have received a copy of the GNU General Public License</span>
0084 <span class="comment">% along with this program; if not, write to the Free Software</span>
0085 <span class="comment">% Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
0086 
0087 <a name="_sub0" href="#_subfunctions" class="code">function [handlers, outheight, allhandlers] = supergui( varargin);</a>
0088 
0089 <span class="comment">% handlers cell format</span>
0090 <span class="comment">% allhandlers linear format</span>
0091 handlers = {};
0092 outheight = 0;
0093 
0094 <span class="keyword">if</span> nargin &lt; 2
0095     help <a href="supergui.html" class="code" title="function [handlers, outheight, allhandlers] = supergui( varargin);">supergui</a>;
0096     <span class="keyword">return</span>;
0097 <span class="keyword">end</span>;
0098 
0099 warning off MATLAB:hg:uicontrol:ParameterValuesMustBeValid
0100 
0101 <span class="comment">% decoding input and backward compatibility</span>
0102 <span class="comment">% -----------------------------------------</span>
0103 <span class="keyword">if</span> isstr(varargin{1})
0104     options = varargin;
0105 <span class="keyword">else</span>
0106     options = { <span class="string">'fig'</span>      varargin{1} <span class="string">'geomhoriz'</span> varargin{2} <span class="keyword">...</span>
0107                 <span class="string">'geomvert'</span> varargin{3} <span class="string">'uilist'</span>    varargin(4:end) }; 
0108 <span class="keyword">end</span>
0109 g = <a href="finputcheck.html" class="code" title="function [g, varargnew] = finputcheck( vararg, fieldlist, callfunc, mode, verbose )">finputcheck</a>(options, { <span class="string">'geomhoriz'</span> <span class="string">'cell'</span>   []      {};
0110                            <span class="string">'fig'</span>       <span class="string">''</span>   []      0;
0111                            <span class="string">'geom'</span>      <span class="string">'cell'</span>   []      {};
0112                            <span class="string">'uilist'</span>    <span class="string">'cell'</span>   []      {};
0113                            <span class="string">'title'</span>     <span class="string">'string'</span> []      <span class="string">''</span>;
0114                            <span class="string">'userdata'</span>  <span class="string">''</span>       []      [];
0115                            <span class="string">'geomvert'</span>  <span class="string">'real'</span>   []      [];
0116                            <span class="string">'horizontalalignment'</span>  <span class="string">'string'</span>   { <span class="string">'left'</span> <span class="string">'right'</span> <span class="string">'center'</span> } <span class="string">'left'</span>;
0117                            <span class="string">'minwidth'</span>  <span class="string">'real'</span>   []      10;
0118                            <span class="string">'borders'</span>   <span class="string">'real'</span>   []      [0.05 0.04 0.07 0.06];
0119                            <span class="string">'spacing'</span>   <span class="string">'real'</span>   []      [0.02 0.01];
0120                            <span class="string">'inseth'</span>    <span class="string">'real'</span>   []      0.02; <span class="comment">% x border absolute (5% of width)</span>
0121                            <span class="string">'insetv'</span>    <span class="string">'real'</span>   []      0.02 }, <span class="string">'supergui'</span>);
0122 <span class="keyword">if</span> isstr(g), error(g); <span class="keyword">end</span>
0123 <span class="keyword">if</span> ~isempty(g.geomhoriz)
0124     maxcount = sum(cellfun(<span class="string">'length'</span>, g.geomhoriz));
0125     <span class="keyword">if</span> maxcount ~= length(g.uilist)
0126         warning(<span class="string">'Wrong size for ''geomhoriz'' input'</span>);
0127     <span class="keyword">end</span>;
0128     <span class="keyword">if</span> ~isempty(g.geomvert)
0129         <span class="keyword">if</span> length(g.geomvert) ~= length(g.geomhoriz)
0130             warning(<span class="string">'Wrong size for ''geomvert'' input'</span>);
0131         <span class="keyword">end</span>;
0132     <span class="keyword">end</span>;
0133     g.insetv = g.insetv/length(g.geomhoriz);
0134 <span class="keyword">end</span>;
0135 <span class="keyword">if</span> ~isempty(g.geom)
0136     <span class="keyword">if</span> length(g.geom) ~= length(g.uilist)
0137         warning(<span class="string">'Wrong size for ''geom'' input'</span>);
0138     <span class="keyword">end</span>;
0139     maxcount = length(g.geom);
0140 <span class="keyword">end</span>;
0141 
0142 <span class="comment">% create new figure</span>
0143 <span class="comment">% -----------------</span>
0144 <span class="keyword">if</span> g.fig == 0
0145     g.fig = figure(<span class="string">'visible'</span>,<span class="string">'off'</span>);
0146 <span class="keyword">end</span>
0147 
0148 <span class="comment">% converting the geometry formats</span>
0149 <span class="comment">% -------------------------------</span>
0150 <span class="keyword">if</span> ~isempty(g.geomhoriz) &amp; ~iscell( g.geomhoriz )
0151     oldgeom = g.geomhoriz;
0152     g.geomhoriz = {};
0153     <span class="keyword">for</span> row = 1:length(oldgeom)
0154         g.geomhoriz = { g.geomhoriz{:} ones(1, oldgeom(row)) };
0155     <span class="keyword">end</span>;
0156 <span class="keyword">end</span>
0157 <span class="keyword">if</span> isempty(g.geomvert)
0158     g.geomvert = ones(1, length(g.geomhoriz));
0159 <span class="keyword">end</span>
0160 
0161 <span class="comment">% converting to the new format</span>
0162 <span class="comment">% ----------------------------</span>
0163 <span class="keyword">if</span> isempty(g.geom)
0164     count = 1;
0165     incy  = 0;
0166     sumvert  = sum(g.geomvert);
0167     maxhoriz = 1;
0168     <span class="keyword">for</span> row = 1:length(g.geomhoriz)
0169         incx = 0;
0170         maxhoriz = max(maxhoriz, length(g.geomhoriz{row}));
0171         ratio = length(g.geomhoriz{row})/sum(g.geomhoriz{row});
0172         <span class="keyword">for</span> column = 1:length(g.geomhoriz{row})
0173             g.geom{count} = { length(g.geomhoriz{row}) sumvert [incx incy] [g.geomhoriz{row}(column)*ratio g.geomvert(row)] };
0174             incx = incx+g.geomhoriz{row}(column)*ratio;
0175             count = count+1;
0176         <span class="keyword">end</span>;
0177         incy = incy+g.geomvert(row);
0178     <span class="keyword">end</span>;
0179     g.borders(1:2) = g.borders(1:2)/maxhoriz*5;
0180     g.borders(3:4) = g.borders(3:4)/sumvert*10;
0181     g.spacing(1)   = g.spacing(1)/maxhoriz*5;
0182     g.spacing(2)   = g.spacing(2)/sumvert*10;
0183 <span class="keyword">end</span>;
0184 
0185 <span class="comment">% get axis coordinates</span>
0186 <span class="comment">% --------------------</span>
0187 <span class="keyword">try</span> 
0188     set(g.fig, <span class="string">'menubar'</span>, <span class="string">'none'</span>, <span class="string">'numbertitle'</span>, <span class="string">'off'</span>);
0189 <span class="keyword">catch</span>
0190 <span class="keyword">end</span>
0191     
0192 pos = [0 0 1 1]; <span class="comment">% plot relative to current axes</span>
0193 q = [pos(1) pos(2) 0 0];
0194 s = [pos(3) pos(4) pos(3) pos(4)]; <span class="comment">% allow to use normalized position [0 100] for x and y</span>
0195 axis(<span class="string">'off'</span>);
0196 
0197 <span class="comment">% creating guis</span>
0198 <span class="comment">% -------------</span>
0199 row    = 1; <span class="comment">% count the elements</span>
0200 column = 1; <span class="comment">% count the elements</span>
0201 factmultx = 0;
0202 factmulty = 0; <span class="comment">%zeros(length(g.geomhoriz));</span>
0203 <span class="keyword">for</span> counter = 1:maxcount
0204 
0205     <span class="comment">% init</span>
0206     clear rowhandle;
0207     gm = g.geom{counter};
0208     [posx posy width height] = <a href="#_sub1" class="code" title="subfunction [posx posy width height] = getcoord(geom1, geom2, coord1, sz, borders, spacing);">getcoord</a>(gm{1}, gm{2}, gm{3}, gm{4}, g.borders, g.spacing);
0209     
0210     <span class="keyword">try</span>
0211         currentelem = g.uilist{ counter };
0212     <span class="keyword">catch</span>
0213         fprintf(<span class="string">'Warning: not all boxes were filled\n'</span>);
0214         <span class="keyword">return</span>;
0215     <span class="keyword">end</span>;        
0216     <span class="keyword">if</span> ~isempty(currentelem)
0217         <span class="comment">% decode metadata</span>
0218         <span class="comment">% ---------------</span>
0219         <span class="keyword">if</span> strcmpi(currentelem{1}, <span class="string">'link2lines'</span>), 
0220             currentelem(1) = []; 
0221             hf1 = 3.6/2-0.3;
0222             hf2 = 0.7/2-0.3;
0223             allhandlers(counter) = uicontrol(g.fig, <span class="string">'unit'</span>, <span class="string">'normalized'</span>, <span class="string">'position'</span>, <span class="keyword">...</span>
0224                                           [posx-width/2 posy+hf1*height width/2 0.005].*s+q, <span class="string">'style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'string'</span>, <span class="string">''</span>);
0225             allhandlers(counter) = uicontrol(g.fig, <span class="string">'unit'</span>, <span class="string">'normalized'</span>, <span class="string">'position'</span>, <span class="keyword">...</span>
0226                                           [posx-width/2 posy+hf2*height width/2 0.005].*s+q, <span class="string">'style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'string'</span>, <span class="string">''</span>);
0227             allhandlers(counter) = uicontrol(g.fig, <span class="string">'unit'</span>, <span class="string">'normalized'</span>, <span class="string">'position'</span>, <span class="keyword">...</span>
0228                                           [posx posy+hf2*height 0.005 (hf1-hf2+0.1)*height].*s+q, <span class="string">'style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'string'</span>, <span class="string">''</span>);
0229             allhandlers(counter) = uicontrol(g.fig, <span class="string">'unit'</span>, <span class="string">'normalized'</span>, <span class="string">'position'</span>, <span class="keyword">...</span>
0230                                           [posx posy+(hf1+hf2)/2*height width/2 0.005].*s+q, <span class="string">'style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'string'</span>, <span class="string">''</span>);
0231             allhandlers(counter) = 0;
0232         <span class="keyword">else</span>
0233             <span class="keyword">if</span> strcmpi(currentelem{1}, <span class="string">'width'</span>),
0234                  curwidth = currentelem{2};
0235                  currentelem(1:2) = [];
0236             <span class="keyword">else</span> curwidth = 0;
0237             <span class="keyword">end</span>;
0238             <span class="keyword">if</span> strcmpi(currentelem{1}, <span class="string">'align'</span>),
0239                  align = currentelem{2};
0240                  currentelem(1:2) = [];
0241             <span class="keyword">else</span> align = <span class="string">'right'</span>;
0242             <span class="keyword">end</span>;
0243             <span class="keyword">if</span> strcmpi(currentelem{1}, <span class="string">'stickto'</span>),
0244                  stickto = currentelem{2};
0245                  currentelem(1:2) = [];
0246             <span class="keyword">else</span> stickto = <span class="string">'none'</span>;
0247             <span class="keyword">end</span>;
0248             <span class="keyword">if</span> strcmpi(currentelem{1}, <span class="string">'vertshift'</span>), currentelem(1) = []; addvert = -height/2; 
0249             <span class="keyword">else</span>                                                          addvert = 0;   
0250             <span class="keyword">end</span>;
0251             allhandlers(counter) = uicontrol(g.fig, <span class="string">'unit'</span>, <span class="string">'normalized'</span>, <span class="string">'position'</span>, <span class="keyword">...</span>
0252                                           [posx posy+addvert width height].*s+q, currentelem{:});
0253 
0254             <span class="comment">% this simply compute a factor so that all uicontrol will be visible</span>
0255             <span class="comment">% ------------------------------------------------------------------</span>
0256             style = get( allhandlers(counter), <span class="string">'style'</span>);            
0257             set( allhandlers(counter), <span class="string">'units'</span>, <span class="string">'pixels'</span>);        
0258             curpos = get(allhandlers(counter), <span class="string">'position'</span>);
0259             curext = get(allhandlers(counter), <span class="string">'extent'</span>);
0260             <span class="keyword">if</span> curwidth ~= 0
0261                 curwidth = curwidth/((factmultx-1)/1.85+1);
0262                 <span class="keyword">if</span> strcmpi(align, <span class="string">'right'</span>)
0263                     curpos(1) = curpos(1)+curpos(3)-curwidth;
0264                 <span class="keyword">elseif</span> strcmpi(align, <span class="string">'center'</span>)
0265                     curpos(1) = curpos(1)+curpos(3)/2-curwidth/2;
0266                 <span class="keyword">end</span>;
0267                 set(allhandlers(counter), <span class="string">'position'</span>, [ curpos(1) curpos(2) curwidth curpos(4) ]);
0268                 <span class="keyword">if</span> strcmpi(stickto, <span class="string">'on'</span>)
0269                     set( allhandlers(counter-1), <span class="string">'units'</span>, <span class="string">'pixels'</span>);
0270                     curpos2 = get(allhandlers(counter-1), <span class="string">'position'</span>);
0271                     set(allhandlers(counter-1), <span class="string">'position'</span>, [ curpos(1)-curpos2(3)-10 curpos2(2) curpos2(3) curpos2(4) ]);
0272                     set( allhandlers(counter-1), <span class="string">'units'</span>, <span class="string">'normalized'</span>);
0273                 <span class="keyword">end</span>;
0274                 curext(3) = curwidth;
0275             <span class="keyword">end</span>;
0276             set( allhandlers(counter), <span class="string">'units'</span>, <span class="string">'normalized'</span>);            
0277 
0278             <span class="keyword">if</span> ~strcmp(style, <span class="string">'edit'</span>) &amp; ~strcmp(style, <span class="string">'pushbutton'</span>)
0279                 <span class="comment">%tmp = curext(3)/curpos(3);</span>
0280                 <span class="comment">%if tmp &gt; 3*factmultx &amp;&amp; factmultx &gt; 0, adsfasd; end;</span>
0281                 factmultx = max(factmultx, curext(3)/curpos(3));
0282             <span class="keyword">end</span>;
0283             <span class="keyword">if</span>  ~strcmp(style, <span class="string">'listbox'</span>)
0284                 factmulty = max(factmulty, curext(4)/curpos(4));
0285             <span class="keyword">end</span>;
0286 
0287             <span class="comment">% Uniformize button text aspect (first letter must be upercase)</span>
0288             <span class="comment">% -----------------------------</span>
0289             <span class="keyword">if</span> strcmp(style, <span class="string">'pushbutton'</span>)
0290                 tmptext = get(allhandlers(counter), <span class="string">'string'</span>);
0291                 <span class="keyword">if</span> length(tmptext) &gt; 1
0292                     <span class="keyword">if</span> upper(tmptext(1)) ~= tmptext(1) | lower(tmptext(2)) ~= tmptext(2)
0293                         tmptext = lower(tmptext);
0294                         <span class="keyword">try</span>, tmptext(1) = upper(tmptext(1)); <span class="keyword">catch</span>, <span class="keyword">end</span>;
0295                     <span class="keyword">end</span>;
0296                 <span class="keyword">end</span>;
0297                 set(allhandlers(counter), <span class="string">'string'</span>, tmptext);
0298             <span class="keyword">end</span>;
0299         <span class="keyword">end</span>;
0300     <span class="keyword">else</span> 
0301         allhandlers(counter) = 0;
0302     <span class="keyword">end</span>;
0303 <span class="keyword">end</span>;
0304 
0305 <span class="comment">% adjustments</span>
0306 <span class="comment">% -----------</span>
0307 factmultx = factmultx*1.02;<span class="comment">% because some text was still hidden</span>
0308 <span class="comment">%factmultx = factmultx*1.2;</span>
0309 <span class="keyword">if</span> factmultx &lt; 0.1
0310     factmultx = 0.1;
0311 <span class="keyword">end</span>;
0312 
0313 <span class="comment">% for MAC (magnify figures that have edit fields)</span>
0314 <span class="comment">% -------</span>
0315 warning off;
0316 <span class="keyword">try</span>, 
0317     comp = computer;
0318     <span class="keyword">if</span> length(comp) &gt; 2 &amp;&amp; strcmpi(comp(1:3), <span class="string">'MAC'</span>)
0319         factmulty = factmulty*1.5;
0320     <span class="keyword">elseif</span> ~isunix <span class="comment">% windows</span>
0321         factmulty = factmulty*1.08;
0322     <span class="keyword">end</span>;
0323 <span class="keyword">catch</span>, <span class="keyword">end</span>;
0324 factmulty = factmulty*0.9; <span class="comment">% global shinking</span>
0325 warning on;    
0326 
0327 <span class="comment">% scale and replace the figure in the screen</span>
0328 <span class="comment">% -----------------------------------------</span>
0329 pos = get(g.fig, <span class="string">'position'</span>);
0330 <span class="keyword">if</span> factmulty &gt; 1
0331     pos(2) = max(0,pos(2)+pos(4)-pos(4)*factmulty);
0332 <span class="keyword">end</span>;
0333 pos(1) = pos(1)+pos(3)*(1-factmultx)/2;
0334 pos(3) = max(pos(3)*factmultx, g.minwidth);
0335 pos(4) = pos(4)*factmulty;
0336 set(g.fig, <span class="string">'position'</span>, pos);
0337 
0338 <span class="comment">% vertical alignment to bottom for text</span>
0339 <span class="comment">% ---------------------------------------</span>
0340 <span class="keyword">for</span> index = 1:length(allhandlers)
0341     <span class="keyword">if</span> allhandlers(index) ~= 0
0342         <span class="keyword">if</span> strcmp(get(allhandlers(index), <span class="string">'style'</span>), <span class="string">'text'</span>)
0343             set(allhandlers(index), <span class="string">'unit'</span>, <span class="string">'pixel'</span>);
0344             curpos = get(allhandlers(index), <span class="string">'position'</span>);
0345             curext = get(allhandlers(index), <span class="string">'extent'</span>);
0346             set(allhandlers(index), <span class="string">'position'</span>, [curpos(1) curpos(2)-4 curpos(3) curext(4)]);
0347             set(allhandlers(index), <span class="string">'unit'</span>, <span class="string">'normalized'</span>);
0348         <span class="keyword">end</span>;
0349     <span class="keyword">end</span>;
0350 <span class="keyword">end</span>;
0351 
0352 <span class="comment">% setting defaults colors</span>
0353 <span class="comment">%------------------------</span>
0354 <span class="keyword">try</span>, icadefs;
0355 <span class="keyword">catch</span>,
0356     GUIBACKCOLOR        = [.66 .76 1];
0357     GUIPOPBUTTONCOLOR   = [.93 .96 1];
0358     GUITEXTCOLOR        = [0 0 0.4];
0359 <span class="keyword">end</span>;
0360 
0361 hh = findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'text'</span>);
0362 <span class="comment">%set(hh, 'BackgroundColor', get(g.fig, 'color'), 'horizontalalignment', 'left');</span>
0363 set(hh, <span class="string">'Backgroundcolor'</span>, GUIBACKCOLOR);
0364 set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0365 <span class="keyword">try</span>
0366 set(g.fig, <span class="string">'color'</span>,GUIBACKCOLOR );
0367 <span class="keyword">catch</span>
0368 <span class="keyword">end</span>
0369 set(hh, <span class="string">'horizontalalignment'</span>, g.horizontalalignment);
0370 
0371 hh = findobj(allhandlers, <span class="string">'style'</span>, <span class="string">'edit'</span>);
0372 set(hh, <span class="string">'BackgroundColor'</span>, [1 1 1]); <span class="comment">%, 'horizontalalignment', 'right');</span>
0373 
0374 hh =findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'pushbutton'</span>);
0375 comp = computer;
0376 <span class="keyword">if</span> length(comp) &lt; 3 || ~strcmpi(comp(1:3), <span class="string">'MAC'</span>) <span class="comment">% this puts the wrong background on macs</span>
0377     set(hh, <span class="string">'backgroundcolor'</span>, GUIPOPBUTTONCOLOR);
0378     set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0379 <span class="keyword">end</span>;
0380 hh =findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'popupmenu'</span>);
0381 set(hh, <span class="string">'backgroundcolor'</span>, GUIPOPBUTTONCOLOR);
0382 set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0383 hh =findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'checkbox'</span>);
0384 set(hh, <span class="string">'backgroundcolor'</span>, GUIBACKCOLOR);
0385 set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0386 hh =findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'listbox'</span>);
0387 set(hh, <span class="string">'backgroundcolor'</span>, GUIPOPBUTTONCOLOR);
0388 set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0389 hh =findobj(allhandlers, <span class="string">'parent'</span>, g.fig, <span class="string">'style'</span>, <span class="string">'radio'</span>);
0390 set(hh, <span class="string">'foregroundcolor'</span>, GUITEXTCOLOR);
0391 set(hh, <span class="string">'backgroundcolor'</span>, GUIPOPBUTTONCOLOR);
0392 set(g.fig, <span class="string">'visible'</span>, <span class="string">'on'</span>);
0393 
0394 <span class="comment">% set userdata and title</span>
0395 <span class="comment">% ----------------------</span>
0396 <span class="keyword">if</span> ~isempty(g.userdata), set(g.fig, <span class="string">'userdata'</span>, g.userdata); <span class="keyword">end</span>;
0397 <span class="keyword">if</span> ~isempty(g.title   ), set(g.fig, <span class="string">'name'</span>,     g.title   ); <span class="keyword">end</span>;
0398 
0399 <span class="keyword">return</span>;
0400 
0401 <a name="_sub1" href="#_subfunctions" class="code">function [posx posy width height] = getcoord(geom1, geom2, coord1, sz, borders, spacing);</a>
0402     
0403     coord2 = coord1+sz;
0404     borders(1:2) = borders(1:2)-spacing(1);
0405     borders(3:4) = borders(3:4)-spacing(2);
0406     
0407     <span class="comment">% absolute positions</span>
0408     posx   = coord1(1)/geom1;
0409     posy   = coord1(2)/geom2;
0410     posx2  = coord2(1)/geom1;
0411     posy2  = coord2(2)/geom2;
0412     width  = posx2-posx;
0413     height = posy2-posy;
0414 
0415     <span class="comment">% add spacing</span>
0416     posx   = posx+spacing(1)/2;
0417     width  = max(posx2-posx-spacing(1), 0.001);
0418     height = max(posy2-posy-spacing(2), 0.001);
0419     posy   = max(0, 1-posy2)+spacing(2)/2;
0420     
0421     <span class="comment">% add border</span>
0422     posx   = posx*(1-borders(1)-borders(2))+borders(1);
0423     posy   = posy*(1-borders(3)-borders(4))+borders(4);
0424     width  = width*( 1-borders(1)-borders(2));
0425     height = height*(1-borders(3)-borders(4));
0426     
0427 <a name="_sub2" href="#_subfunctions" class="code">function [posx posy width height] = getcoordold(geom1, geom2, coord1, sz);</a>
0428     
0429     coord2 = coord1+sz;
0430     horiz_space  = 0.05/geom1;
0431     vert_space   = 0.05/geom2;
0432     horiz_border = min(0.1, 1/geom1)-horiz_space;
0433     vert_border  = min(0.2, 1.5/geom2)-vert_space;
0434     
0435     <span class="comment">% absolute positions</span>
0436     posx   = coord1(1)/geom1;
0437     posy   = coord1(2)/geom2;
0438     posx2  = coord2(1)/geom1;
0439     posy2  = coord2(2)/geom2;
0440     width  = posx2-posx;
0441     height = posy2-posy;
0442 
0443     <span class="comment">% add spacing</span>
0444     posx   = posx+horiz_space/2;
0445     width  = max(posx2-posx-horiz_space, 0.001);
0446     height = max(posy2-posy- vert_space, 0.001);
0447     posy   = max(0, 1-posy2)+vert_space/2;
0448     
0449     <span class="comment">% add border</span>
0450     posx   = posx*(1-horiz_border)+horiz_border/2;
0451     posy   = posy*(1- vert_border)+vert_border/2;
0452     width  = width*(1-horiz_border);
0453     height = height*(1-vert_border);
0454  
0455     <span class="comment">%     posx   = coord1(1)/geom1+horiz_border*1/geom1/2;</span>
0456 <span class="comment">%     posy   = 1-(coord1(2)/geom2+vert_border*1/geom2/2)-1/geom2;</span>
0457 <span class="comment">%</span>
0458 <span class="comment">%     posx2  = coord2(1)/geom1+horiz_border*1/geom1/2;</span>
0459 <span class="comment">%     posy2  = 1-(coord2(2)/geom2+vert_border*1/geom2/2)-1/geom2;</span>
0460 <span class="comment">%</span>
0461 <span class="comment">%     width  = posx2-posx;</span>
0462 <span class="comment">%     height = posy-posy2;</span>
0463     
0464     <span class="comment">%h = axes('unit', 'normalized', 'position', [ posx posy width height ]);</span>
0465     <span class="comment">%h = axes('unit', 'normalized', 'position', [ coordx/geom1 1-coordy/geom2-1/geom2 1/geom1 1/geom2 ]);</span></pre></div>

<hr><address>Generated on Wed 19-Aug-2015 18:06:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>